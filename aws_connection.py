import boto3
import os

def upload_to_s3(bucket, contents, file_name, access_key=None, secret_key=None):
    if access_key is None:
        access_key = os.environ.get("AWS_ACCESS_KEY_ID")

    if secret_key is None:
        secret_key = os.environ.get("AWS_SECRET_ACCESS_KEY")

    # Create S3 client
    s3 = boto3.client('s3', aws_access_key_id=access_key, aws_secret_access_key=secret_key)

    # Upload to S3 as a file
    s3.put_object(Bucket=bucket, Key=file_name, Body=contents)


if __name__ == '__main__':
    sample = """{"quiz_data": [{"question": "Who is the author of the novel 'Pride and Prejudice'?", "options": ["Mary Shelley", "Jane Austen", "Emily Bronte", "Charlotte Bronte"], "answer": "Jane Austen", "explanation": "Jane Austen is the author of the classic novel 'Pride and Prejudice'."}, {"question": "Who is the protagonist of the novel 'Pride and Prejudice'?", "options": ["Elizabeth Bennet", "Lady Catherine de Bourgh", "Mr. Darcy", "Jane Bennet"], "answer": "Elizabeth Bennet", "explanation": "Elizabeth Bennet is the main character and the protagonist of the novel 'Pride and Prejudice' written by Jane Austen."}, {"question": "What is the main theme of the novel 'Pride and Prejudice'?", "options": ["Love and marriage", "Family dynamics", "Social class", "Gender roles"], "answer": "Love and marriage", "explanation": "'Pride and Prejudice' explores the theme of love and marriage, examining societal expectations, personal choices, and the impact of societal norms on romantic relationships."}, {"question": "Who is the love interest of Elizabeth Bennet in 'Pride and Prejudice'?", "options": ["Mr. Wickham", "Mr. Bingley", "Colonel Fitzwilliam", "Mr. Darcy"], "answer": "Mr. Darcy", "explanation": "Mr. Darcy is the love interest of Elizabeth Bennet in 'Pride and Prejudice'. Initially, their relationship is marked by misunderstandings and prejudices, but eventually they overcome these obstacles and fall in love."}, {"question": "Where is the novel 'Pride and Prejudice' set?", "options": ["Bath", "Hertfordshire", "Derbyshire", "London"], "answer": "Hertfordshire", "explanation": "'Pride and Prejudice' is primarily set in the fictional county of Hertfordshire in England. The story revolves around the Bennet family and their interactions with the people of Hertfordshire, particularly in the town of Meryton."}, {"question": "Who is the character known for his famous proposal, 'You must allow me to tell you how ardently I admire and love you' in 'Pride and Prejudice'?", "options": ["Colonel Fitzwilliam", "Mr. Wickham", "Mr. Darcy", "Mr. Bingley"], "answer": "Mr. Darcy", "explanation": "Mr. Darcy is the character who famously proposes to Elizabeth Bennet with the line, 'You must allow me to tell you how ardently I admire and love you.' This proposal occurs during a pivotal moment in the novel and has a significant impact on their relationship."}, {"question": "Which of the Bennet sisters is the oldest in 'Pride and Prejudice'?", "options": ["Jane Bennet", "Mary Bennet", "Elizabeth Bennet", "Lydia Bennet"], "answer": "Jane Bennet", "explanation": "Jane Bennet is the oldest sister in the Bennet family in 'Pride and Prejudice'. She is described as beautiful, kind, and gentle, and plays a prominent role in the novel as the love interest of Mr. Bingley."}, {"question": "In 'Pride and Prejudice', who is the mother of the Bennet sisters?", "options": ["Mrs. Bennet", "Mrs. Phillips", "Mrs. Gardiner", "Lady Catherine de Bourgh"], "answer": "Mrs. Bennet", "explanation": "Mrs. Bennet is the mother of the Bennet sisters in 'Pride and Prejudice'. She is known for her obsession with marrying off her daughters and securing their future. Her character often provides comedic relief in the novel with her exaggerated behavior and relentless matchmaking efforts."}, {"question": "In 'Pride and Prejudice', what is the occupation of Mr. Bennet, the father of the Bennet sisters?", "options": ["Clergyman", "Doctor", "Lawyer", "Landowner"], "answer": "Landowner", "explanation": "Mr. Bennet is a landowner in 'Pride and Prejudice'. He is the husband of Mrs. Bennet and the father of the Bennet sisters. While he is portrayed as a witty and intelligent man, he is often shown as being distant and indifferent to the affairs of his family."}, {"question": "Who is the main antagonist in 'Pride and Prejudice'?", "options": ["Mr. Darcy", "Mr. Wickham", "Mr. Bingley", "Lady Catherine de Bourgh"], "answer": "Mr. Wickham", "explanation": "Mr. Wickham is portrayed as the main antagonist in 'Pride and Prejudice'. He is known for his charming and manipulative nature and creates several conflicts throughout the novel, particularly with Elizabeth Bennet and Mr. Darcy."}, {"question": "In 'Pride and Prejudice', who is Elizabeth Bennet's closest sibling?", "options": ["Lydia Bennet", "Kitty Bennet", "Jane Bennet", "Mary Bennet"], "answer": "Jane Bennet", "explanation": "Jane Bennet is Elizabeth Bennet's closest sibling in 'Pride and Prejudice'. They have a strong bond and Jane is often portrayed as the more reserved and gentle sister, while Elizabeth is more outspoken and independent."}, {"question": "In 'Pride and Prejudice', who is the wealthy suitor of Charlotte Lucas?", "options": ["Mr. Collins", "Mr. Bingley", "Mr. Wickham", "Mr. Darcy"], "answer": "Mr. Collins", "explanation": "Mr. Collins is the wealthy suitor of Charlotte Lucas in 'Pride and Prejudice'. Charlotte ultimately accepts Mr. Collins' proposal despite not having a deep emotional connection with him, as she values financial security and stability over romantic love."}]}"""
    upload_to_s3('s3-quiz-llm-bucket', sample, 'pride-and-prejudice.json')
